"0",""
"0","# function to calculate standard error after removing NAs"
"0","sterr <- function(x) {"
"0","  x <- x[!is.na(x)]"
"0","  sd(x)/sqrt(length(x))"
"0","}"
"0",""
"0","res_descriptives <- res %>%"
"0","  select(-c(T,p,pcorr,name)) %>% "
"0","  unnest(data) %>% "
"0","  mutate(name = str_replace_all(name, ""_"", "" "")) %>% "
"0","  group_by(JU, name, D_bins, contrast, pcorr_sig) %>% "
"0","  summarise("
"0","    meanZ = mean(isc, na.rm = T),"
"0","    sterrZ = sterr(isc),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0",""
"0",""
"0","fig <- res_descriptives %>%"
"0","  mutate(pcorr_sig = ifelse(contrast == ""Motion"", pcorr_sig, NA)) %>%  # to plot only one asterisk"
"0","  ggplot( aes(x = D_bins, y = meanZ, fill = contrast) ) +"
"0","  geom_bar(stat = ""identity"", position = position_identity(), alpha = 0.6) +"
"0","  geom_text("
"0","    aes(x = pcorr_sig, y = meanZ + 0, label = ""*""), fontface = ""bold"", size=10, na.rm = T"
"0","  ) +"
"0","  geom_linerange(aes(ymin = meanZ - sterrZ, ymax = meanZ + sterrZ, color=contrast), alpha = 0.5) +"
"0","  # coord_cartesian(ylim = c(zthr, max(res_descriptives$meanZ) + 0.2)) +"
"0","  facet_wrap(~ name, scales = ""free"", labeller = label_wrap_gen(width=22)) +"
"0","  theme_minimal() +"
"0","  labs("
"0","    title = ""Mean ISC parameter estimates for each Depth bin in each Juelich region across participants"""
"0","  ) +"
"0","  ylab(""Mean ISC estimate across participants"") + "
"0","  xlab(""Cortical Depth bins :  1 = WM/GM border, 6 = pial"") +"
"0","  theme("
"0","    strip.text.x = element_text(size = 11), # increase size of title for each subplot"
"0","    panel.spacing.y = unit(3, ""lines"")      # increase space between facets"
"0","  ) +"
"0","  coord_flip()"
"0",""
"0","fig"
