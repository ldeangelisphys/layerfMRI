"0",""
"0","ISC_estimates_nest <- ISC_estimates %>%"
"0","  select(-c(tc_concatenated, X)) %>%"
"0","  inner_join(julabels, by=c(""JU""=""numba"")) %>%"
"0","  group_by(JU,D_bins) %>%"
"0","  nest()"
"0",""
"0",""
"0","# Function to test Motion > Scrambled in every nested df"
"0","# It's defined outside so that it can be easily modified to be something"
"0","# other than t.test"
"0","compare_contrasts <- function(df) {"
"0","  t.test(df %>% filter(contrast == ""Motion"") %>% select(isc) %>% pull(), "
"0","         df %>% filter(contrast == ""Scrambled"") %>% select(isc) %>% pull(), "
"0","         paired = TRUE)"
"0","}"
"0",""
"0",""
"0","# Carry out the comparison Motion > Scrambled for each D_bin in each JU ROI"
"0","ttest_res <- ISC_estimates_nest %>% "
"0","  mutate("
"0","    ttest = map(data, compare_contrasts)"
"0","  )"
"0",""
"0",""
"0","library(broom)"
"0",""
"0","# # Use the line below to check which estimates to extract"
"0","# ttest_res$ttest[[1]] %>% glance()"
"0",""
"0","# Extract the parameters of interest (T,p)"
"0","ttest_res <- ttest_res %>% "
"0","  mutate("
"0","    glance = ttest %>% map(glance),"
"0","    T = glance %>% map_dbl(""statistic""),"
"0","    p = glance %>% map_dbl(""p.value"")"
"0","  )"
"0",""
"0",""
